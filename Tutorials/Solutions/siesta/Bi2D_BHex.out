--------------------------------------------------------------------------
WARNING: Linux kernel CMA support was requested via the
btl_vader_single_copy_mechanism MCA variable, but CMA support is
not available due to restrictive ptrace settings.

The vader shared memory BTL will fall back on another single-copy
mechanism if one is available. This may result in lower performance.

  Local host: LAPTOP-RVTIC4GC
--------------------------------------------------------------------------
Siesta Version  : siesta-psml-778-608
Architecture    : gfortran-gridxc-0.8.5-legacy
Compiler version: GNU Fortran (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0
Compiler flags  : mpif90 -O0 -fbacktrace
PP flags        : -DCDF -DNCDF -DNCDF_3  -DMPI -DMPI_TIMING  -DF2003
Libraries       : libncdf.a libfdict.a -lnetcdff -lnetcdf -lhdf5_hl -lhdf5 -lz -llapack -lblas  -L/home/juijan/compile/scalapack-2.0.2 -lscalapack   libncdf.a libfdict.a
Directory       : /mnt/c/Users/nilsw/Projects/2019/Schools/Tutorials/Exercise/siesta
PARALLEL version
NetCDF support

* Running on 4 nodes in parallel
>> Start of run:  19-FEB-2020  10:05:37

                           ***********************       
                           *  WELCOME TO SIESTA  *       
                           ***********************       

reinit: Reading from Bi2D_BHex.fdf

reinit: -----------------------------------------------------------------------
reinit: System Name: Bi2D_BHex
reinit: -----------------------------------------------------------------------
reinit: System Label: Bi2D_BHex
reinit: -----------------------------------------------------------------------

initatom: Reading input for the pseudopotentials and atomic orbitals ----------
Species number:   1 Atomic number:   83 Label: Bi

Ground state valence configuration:   6s02  6p03

Reading pseudopotential from: Bi.psml

PSML file version: 1.1
Using libxc ids:  101 130
GGA--PBE XC_GGA_X_PBE--XC_GGA_C_PBE pb
 Using ATOM defaults for log grid...
PSML uuid: 1d199580-4728-11e8-74b9-45df666a9ad3
Dumping pseudopotential information in formatted form in Bi.psdump
Semicore shell(s) with 10 electrons included in the valence for
Bi
For Bi, standard SIESTA heuristics set lmxkb to 3
 (one more than the basis l, including polarization orbitals).
Use PS.lmax or PS.KBprojectors blocks to override.
Bi: nkbl increased for l=2 due to the presence of a polarization orbital
Bi pseudopotential only contains V_ls up to l=2 -- lmxkb reset.

<basis_specs>
===============================================================================
Bi                   Z=  83    Mass=  208.98        Charge= 0.17977+309
Lmxo=2 Lmxkb= 2    BasisType=split      Semic=T
L=0  Nsemic=0  Cnfigmx=6
          i=1  nzeta=1  polorb=0  (6s)
            splnorm:   0.15000    
               vcte:    0.0000    
               rinn:    0.0000    
               qcoe:    0.0000    
               qyuk:    0.0000    
               qwid:   0.10000E-01
                rcs:    4.8610    
            lambdas:    1.0000    
L=1  Nsemic=0  Cnfigmx=6
          i=1  nzeta=1  polorb=1  (6p)  (to be polarized perturbatively)
            splnorm:   0.15000    
               vcte:    0.0000    
               rinn:    0.0000    
               qcoe:    0.0000    
               qyuk:    0.0000    
               qwid:   0.10000E-01
                rcs:    6.3990    
            lambdas:    1.0000    
L=2  Nsemic=0  Cnfigmx=5
          i=1  nzeta=1  polorb=0  (5d)
            splnorm:   0.15000    
               vcte:    0.0000    
               rinn:    0.0000    
               qcoe:    0.0000    
               qyuk:    0.0000    
               qwid:   0.10000E-01
                rcs:    3.2580    
            lambdas:    1.0000    
-------------------------------------------------------------------------------
L=0  Nkbl=1  erefs: 0.17977+309
L=1  Nkbl=1  erefs: 0.17977+309
L=2  Nkbl=2  erefs: 0.17977+309 0.17977+309
===============================================================================
</basis_specs>

atom: Called for Bi                    (Z =  83)

read_vps: Pseudopotential generation method:
read_vps: ONCVPSP-3.Hamann's oncvpsp                        
Total valence charge:   15.00000

read_vps: Pseudopotential includes a core correction:
read_vps: Pseudo-core for xc-correction

xc_check: Exchange-correlation functional:
xc_check: GGA Perdew, Burke & Ernzerhof 1996
Got Vlocal (oncv-fit) from psml data
Choosing vlocal chloc cutoff:  4.131548
qtot up to nchloc:   15.00179647
atom: Maximum radius forchloc:    4.13155
atom: Maximum radius for r*vlocal+2*Zval:    4.13155
Reading KB projs from Bi psml data
Using lj projectors in PSML file

PSML: Kleinman-Bylander projectors: 
   l= 0   rc=  2.474770   Ekb=  1.712941
   l= 0   rc=  2.474770   Ekb= 11.335126
j- l= 1   rc=  2.569337   Ekb=  1.346984
j+ l= 1   rc=  2.569337   Ekb=  0.959914
j- l= 1   rc=  2.569337   Ekb=  9.277226
j+ l= 1   rc=  2.569337   Ekb=  8.466419
j- l= 2   rc=  2.130050   Ekb= -7.269185
j+ l= 2   rc=  2.130050   Ekb= -6.624556
j- l= 2   rc=  2.130050   Ekb= -1.636120
j+ l= 2   rc=  2.130050   Ekb= -1.401486

PSML: Total number of  Kleinman-Bylander projectors:  34
atom: -------------------------------------------------------------------------

atom: SANKEY-TYPE ORBITALS:

SPLIT: Orbitals with angular momentum L= 0

SPLIT: Basis orbitals for state 6s

   izeta = 1
                 lambda =    1.000000
                     rc =    4.860558
                 energy =   -1.040630
                kinetic =    0.659530
    potential(screened) =   -1.700160
       potential(ionic) =  -14.393872

SPLIT: Orbitals with angular momentum L= 1

SPLIT: Basis orbitals for state 6p

   izeta = 1
                 lambda =    1.000000
                     rc =    6.399083
                 energy =   -0.317260
                kinetic =    0.736876
    potential(screened) =   -1.054136
       potential(ionic) =  -11.346061

SPLIT: Orbitals with angular momentum L= 2

SPLIT: Basis orbitals for state 5d

   izeta = 1
                 lambda =    1.000000
                     rc =    3.258120
                 energy =   -1.959391
                kinetic =    7.659278
    potential(screened) =   -9.618668
       potential(ionic) =  -26.283006

POLgen: Perturbative polarization orbital with L=  2

POLgen: Polarization orbital for state 6p

   izeta = 1
                     rc =    6.399083
                 energy =    0.269870
                kinetic =    1.171687
    potential(screened) =   -0.901817
       potential(ionic) =  -10.315337
atom: Total number of Sankey-type orbitals: 14

atm_pop: Valence configuration (for local Pseudopot. screening):
 6s( 2.00)                                                            
 6p( 3.00)                                                            
 5d(10.00) 6d( 0.00)                                                  
Vna: chval, zval:   15.00000  15.00000

Vna:  Cut-off radius for the neutral-atom potential:   6.399083
comcore: Pseudo-core radius Rcore=  3.258120

atom: _________________________________________________________________________

prinput: Basis input 
* WARNING: This information might be incomplete!!!
----------------------------------------------------------

PAO.BasisType split     

%block ChemicalSpeciesLabel
    1   83 Bi                      # Species index, atomic number, species label
%endblock ChemicalSpeciesLabel

%block PAO.Basis                 # Define Basis set
# WARNING: This information might be incomplete!!!
Bi                    3                    # Species label, number of l-shells
 n=6   0   1                         # n, l, Nzeta 
   4.861   
   1.000   
 n=6   1   1 P   1                   # n, l, Nzeta, Polarization, NzetaPol
   6.399   
   1.000   
 n=5   2   1                         # n, l, Nzeta 
   3.258   
   1.000   
%endblock PAO.Basis

prinput: ----------------------------------------------------------------------

 CH_OVERLAP: Z1=   14.999680474802272       ZVAL1=   15.000000000000000     
 CH_OVERLAP: Z2=   14.999680474802272       ZVAL2=   15.000000000000000     
Dumping basis to NetCDF file Bi.ion.nc
coor:   Atomic-coordinates input format  =     Cartesian coordinates
coor:                                          (in Angstroms)

siesta: WARNING: XV file not found

siesta: Atomic coordinates (Bohr) and species
siesta:      0.00087   0.00000   0.00000  1        1
siesta:      4.34491   2.50853   3.06136  1        2

siesta: System type = slab      

initatomlists: Number of atoms, orbitals, and projectors:      2    28    68

siesta: ******************** Simulation parameters ****************************
siesta:
siesta: The following are some of the parameters of the simulation.
siesta: A complete list of the parameters used, including default values,
siesta: can be found in file out.fdf
siesta:
redata: Spin configuration                          = spin-orbit+offsite
redata: Number of spin components                   = 8
redata: Time-Reversal Symmetry                      = F
redata: Spin-spiral                                 = F
############################################################
#              Spin-orbit coupling is in beta              #
#           Several options may not be compatible          #
############################################################
redata: Long output                                 =   F
redata: Number of Atomic Species                    =        1
redata: Charge density info will appear in .RHO file
redata: Write Mulliken Pop.                         = NO
redata: Matel table size (NRTAB)                    =     1024
redata: Mesh Cutoff                                 =   400.0000 Ry
redata: Net charge of the system                    =     0.0000 |e|
redata: Min. number of SCF Iter                     =        0
redata: Max. number of SCF Iter                     =     1000
redata: SCF convergence failure will abort job
redata: SCF mix quantity                            = Hamiltonian
redata: Mix DM or H after convergence               =   F
redata: Recompute H after scf cycle                 =   F
redata: Mix DM in first SCF step                    =   F
redata: Write Pulay info on disk                    =   F
redata: New DM Occupancy tolerance                  = 0.000000000001
redata: No kicks to SCF
redata: DM Mixing Weight for Kicks                  =     0.5000
redata: Require Harris convergence for SCF          =   F
redata: Harris energy tolerance for SCF             =     0.000100 eV
redata: Require DM convergence for SCF              =   T
redata: DM tolerance for SCF                        =     0.001000
redata: Require EDM convergence for SCF             =   F
redata: EDM tolerance for SCF                       =     0.001000 eV
redata: Require H convergence for SCF               =   T
redata: Hamiltonian tolerance for SCF               =     0.001000 eV
redata: Require (free) Energy convergence for SCF   =   F
redata: (free) Energy tolerance for SCF             =     0.000100 eV
redata: Using Saved Data (generic)                  =   F
redata: Use continuation files for DM               =   F
redata: Neglect nonoverlap interactions             =   F
redata: Method of Calculation                       = Diagonalization
redata: Electronic Temperature                      =   116.0444 K
redata: Fix the spin of the system                  =   F
redata: Split SR and SO contributions               =   F
redata: Max. number of TDED Iter                    =        1
redata: Number of TDED substeps                     =        3
redata: Dynamics option                             = Single-point calculation
mix.SCF: Pulay mixing                            = Pulay
mix.SCF:    Variant                              = stable
mix.SCF:    History steps                        = 5
mix.SCF:    Linear mixing weight                 =     0.250000
mix.SCF:    Mixing weight                        =     0.250000
mix.SCF:    SVD condition                        = 0.1000E-07
mix.SCF: Spin-component mixing                   all
redata: ***********************************************************************

%block SCF.Mixers
  Pulay
%endblock SCF.Mixers

%block SCF.Mixer.Pulay
  # Mixing method
  method pulay
  variant stable

  # Mixing options
  weight 0.2500
  weight.linear 0.2500
  history 5
%endblock SCF.Mixer.Pulay

DM_history_depth set to one: no extrapolation allowed by default for geometry relaxation
Size of DM history Fstack: 1
Total number of electrons:    30.000000
Total ionic charge:    30.000000

* ProcessorY, Blocksize:    2   8


* Orbital distribution balance (max,min):     8     4

k-point displ. along   1 input, could be:     0.50    0.00
k-point displ. along   2 input, could be:     0.50    0.00
k-point displ. along   3 input, could be:     0.50    0.00

Time-reversal symmetry not used.

siesta: k-grid: Number of k-points =        81
siesta: k-points from Monkhorst-Pack grid
siesta: k-cutoff (effective) =    20.000 Ang
siesta: k-point supercell and displacements
siesta: k-grid:    9   0   0      0.500
siesta: k-grid:    0   9   0      0.500
siesta: k-grid:    0   0   1      0.500

diag: Algorithm                                     = D&C
diag: Parallel over k                               =   F
diag: Use parallel 2D distribution                  =   T
diag: Parallel block-size                           = 8
diag: Parallel distribution                         =     2 x     2
diag: Used triangular part                          = Lower
diag: Absolute tolerance                            =  0.100E-15
diag: Orthogonalization factor                      =  0.100E-05
diag: Memory factor                                 =  1.0000

superc: Internal auxiliary supercell:     5 x     5 x     1  =      25
superc: Number of atoms, orbitals, and projectors:     50    700   1700


ts: **************************************************************
ts: Save H and S matrices                           =    F
ts: Save DM and EDM matrices                        =    F
ts: Fix Hartree potential                           =    F
ts: Only save the overlap matrix S                  =    F
ts: **************************************************************

************************ Begin: TS CHECKS AND WARNINGS ************************
************************ End: TS CHECKS AND WARNINGS **************************


                     ====================================
                        Single-point calculation
                     ====================================

superc: Internal auxiliary supercell:     5 x     5 x     1  =      25
superc: Number of atoms, orbitals, and projectors:     50    700   1700

outcell: Unit cell vectors (Ang):
        4.598450    0.000000    0.000000
       -2.299225    3.982375    0.000000
        0.000000    0.000000   40.000000

outcell: Cell vector modules (Ang)   :    4.598450    4.598450   40.000000
outcell: Cell angles (23,13,12) (deg):     90.0000     90.0000    120.0000
outcell: Cell volume (Ang**3)        :    732.5100
<dSpData1D:S at geom step 0
  <sparsity:sparsity for geom step 0
    nrows_g=28 nrows=8 sparsity=1.9758 nnzs=1549, refcount: 8>
  <dData1D:(new from dSpData1D) n=1549, refcount: 1>
refcount: 1>
new_DM -- step:     1
Initializing Density Matrix...
DM filled with atomic data:
<dSpData2D:DM initialized from atoms
  <sparsity:sparsity for geom step 0
    nrows_g=28 nrows=8 sparsity=1.9758 nnzs=1549, refcount: 9>
  <dData2D:DM n=1549 m=8, refcount: 1>
refcount: 1>
     spin moment: S , {S} =    6.00000   0.00000   0.00000   6.00000
New grid distribution:   1
           1       1:   24    1:   12    1:  122
           2       1:   24    1:   12  123:  243
           3       1:   24   13:   24    1:  122
           4       1:   24   13:   24  123:  243

InitMesh: MESH =    48 x    48 x   486 =     1119744
InitMesh: (bp) =    24 x    24 x   243 =      139968
InitMesh: Mesh cutoff (required, used) =   400.000   401.513 Ry
ExtMesh (bp) on 0 =   108 x    96 x   206 =     2135808
New grid distribution:   2
           1       1:   24    1:   24    1:    6
           2       1:   24    1:   24   13:  233
           3       1:   24    1:   24    7:   12
           4       1:   24    1:   24  234:  243
New grid distribution:   3
           1       1:   24    1:   24    1:   12
           2       1:   24    1:   24   24:  231
           3       1:   24    1:   24   13:   23
           4       1:   24    1:   24  232:  243
Setting up quadratic distribution...
ExtMesh (bp) on 0 =   108 x   108 x    90 =     1049760
PhiOnMesh: Number of (b)points on node 0 =                 3456
PhiOnMesh: nlist on node 0 =               126067

stepf: Fermi-Dirac step function

siesta: Program's energy decomposition (eV):
siesta: Ebs     =      -605.687292
siesta: Eions   =      4884.557299
siesta: Ena     =       277.843337
siesta: Ekin    =      2082.670109
siesta: Enl(+so)      -799.524185
siesta: Eso(nil)         0.000000
siesta: Eldau   =         0.000000
siesta: DEna    =        37.922027
siesta: DUscf   =         1.442380
siesta: DUext   =         0.000000
siesta: Exc     =     -1165.132840
siesta: eta*DQ  =         0.000000
siesta: Emadel  =         0.000000
siesta: Emeta   =         0.000000
siesta: Emolmec =         0.000000
siesta: Ekinion =         0.000000
siesta: Eharris =     -4446.966192
siesta: Etot    =     -4449.336471
siesta: FreeEng =     -4449.337327

        iscf     Eharris(eV)        E_KS(eV)     FreeEng(eV)     dDmax    Ef(eV) dHmax(eV)
   scf:    1    -4446.966192    -4449.336471    -4449.337327  0.476657 -1.556839  5.223133
     spin moment: S , {S} =    1.79038  -0.00599   0.00351   1.79037
timer: Routine,Calls,Time,% = IterSCF        1       5.328  48.03
   scf:    2    -4455.689753    -4452.006591    -4452.006591  0.209609 -2.826424  0.633597
     spin moment: S , {S} =    0.15039   0.00068  -0.00040   0.15039
   scf:    3    -4452.072309    -4452.035837    -4452.035837  0.008171 -2.873307  0.451552
     spin moment: S , {S} =    0.12307   0.00043  -0.00025   0.12306
   scf:    4    -4452.090671    -4452.061832    -4452.061832  0.016598 -2.930129  0.202649
     spin moment: S , {S} =    0.06094  -0.00012   0.00007   0.06094
   scf:    5    -4452.068837    -4452.065457    -4452.065457  0.006686 -2.933331  0.121441
     spin moment: S , {S} =    0.03997  -0.00015   0.00008   0.03997
   scf:    6    -4452.072822    -4452.067633    -4452.067633  0.006323 -2.924217  0.019126
     spin moment: S , {S} =    0.00784  -0.00006   0.00003   0.00784
   scf:    7    -4452.068019    -4452.067729    -4452.067729  0.000826 -2.925940  0.013341
     spin moment: S , {S} =    0.00502  -0.00005   0.00003   0.00502
   scf:    8    -4452.068443    -4452.067800    -4452.067800  0.000966 -2.925716  0.010502
     spin moment: S , {S} =    0.00218  -0.00004   0.00002   0.00218
   scf:    9    -4452.069067    -4452.067847    -4452.067847  0.001037 -2.923135  0.004916
     spin moment: S , {S} =    0.00068  -0.00002   0.00001   0.00068
   scf:   10    -4452.067902    -4452.067849    -4452.067849  0.000164 -2.922702  0.003604
     spin moment: S , {S} =    0.00060  -0.00001   0.00001   0.00060
   scf:   11    -4452.067862    -4452.067850    -4452.067850  0.000105 -2.922413  0.002469
     spin moment: S , {S} =    0.00051  -0.00001   0.00001   0.00051
   scf:   12    -4452.067801    -4452.067851    -4452.067851  0.000147 -2.922264  0.000719
     spin moment: S , {S} =    0.00026  -0.00000   0.00000   0.00026

SCF Convergence by DM+H criterion
max |DM_out - DM_in|         :     0.0001468397
max |H_out - H_in|      (eV) :     0.0007187537
SCF cycle converged after 12 iterations

Using DM_out to compute the final energy and forces

siesta: E_KS(eV) =            -4452.0679

siesta: E_KS - E_eggbox =     -4452.0679
     spin moment: S , {S} =    0.00026  -0.00000   0.00000   0.00026

siesta: Atomic forces (eV/Ang):
----------------------------------------
   Tot   -0.000820    0.000006    0.002322
----------------------------------------
   Max    0.130105
   Res    0.074596    sqrt( Sum f_i^2 / 3N )
----------------------------------------
   Max    0.130105    constrained

Stress-tensor-Voigt (kbar):        2.37        2.34       -0.45       -0.04       -0.02        0.02
(Free)E + p*V (eV/cell)    -4452.7177
Target enthalpy (eV/cell)    -4452.0679

siesta: Program's energy decomposition (eV):
siesta: Ebs     =      -599.976959
siesta: Eions   =      4884.557299
siesta: Ena     =       277.843337
siesta: Ekin    =      2100.894129
siesta: Enl(+so)      -809.701103
siesta: Eso(nil)         0.000000
siesta: Eldau   =         0.000000
siesta: DEna    =        30.348308
siesta: DUscf   =         0.988443
siesta: DUext   =         0.000000
siesta: Exc     =     -1167.883665
siesta: eta*DQ  =         0.000000
siesta: Emadel  =         0.000000
siesta: Emeta   =         0.000000
siesta: Emolmec =         0.000000
siesta: Ekinion =         0.000000
siesta: Eharris =     -4452.067801
siesta: Etot    =     -4452.067851
siesta: FreeEng =     -4452.067851

siesta: Final energy (eV):
siesta:  Band Struct. =    -599.976959
siesta:       Kinetic =    2100.894129
siesta:       Hartree =   13375.803144
siesta:       Eldau   =       0.000000
siesta:      Eso(nil) =       0.000000
siesta:    Ext. field =       0.000000
siesta:   Exch.-corr. =   -1167.883665
siesta:  Ion-electron =  -28780.926495
siesta:       Ion-ion =   10020.045036
siesta:       Ekinion =       0.000000
siesta:         Total =   -4452.067851
siesta:         Fermi =      -2.922264

siesta: Atomic forces (eV/Ang):
siesta:      1    0.005863   -0.005103   -0.127783
siesta:      2   -0.006683    0.005109    0.130105
siesta: ----------------------------------------
siesta:    Tot   -0.000820    0.000006    0.002322

siesta: Stress tensor (static) (eV/Ang**3):
siesta:     0.001482   -0.000023    0.000014
siesta:    -0.000023    0.001459   -0.000011
siesta:     0.000014   -0.000011   -0.000280

siesta: Cell volume =        732.510004 Ang**3

siesta: Pressure (static):
siesta:                Solid            Molecule  Units
siesta:          -0.00000966         -0.00001066  Ry/Bohr**3
siesta:          -0.00088712         -0.00097870  eV/Ang**3
siesta:          -1.42134557         -1.56807341  kBar
(Free)E+ p_basis*V_orbitals  =       -4451.024187
(Free)Eharris+ p_basis*V_orbitals  =       -4451.024137
     spin moment: S , {S} =    0.00026  -0.00000   0.00000   0.00026

siesta: Electric dipole (a.u.)  =   -0.000000    0.000000   -0.000032
siesta: Electric dipole (Debye) =   -0.000000    0.000000   -0.000081

>> End of run:  19-FEB-2020  10:06:25
Job completed
